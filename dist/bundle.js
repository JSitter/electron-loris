!function(e){var t={};function a(s){if(t[s])return t[s].exports;var r=t[s]={i:s,l:!1,exports:{}};return e[s].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=e,a.c=t,a.d=function(e,t,s){a.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:s})},a.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=0)}([function(e,t){class a{constructor(e,t,a,s,r,o){this.id=o,this.sprite=e,this.name=t,this.health=a,this.damage=s,this.cool_down=r,this.direction="left",this.x=0,this.y=0,this.target=!1,this.player=!1}injure(e){return this.health-=e,this.health<=0&&this._deathSequence(),this.health}_deathSequence(){sprite.anims.play(this.name+"-death-"+this.direction)}tick(e){e?attackHostile(e):this.mobStuff()}mobStuff(){console.log(this.name+" stuffz")}attackHostile(e){console.log("ATTACKZ LOCAZHUN!"),console.log(e)}}let s=new Phaser.Scene("One");var r,o,i,l,n,h=!0;s.init=function(){this.playerSpeed=1.5,this.enemySpeed=2},s.preload=function(){this.load.plugin("AnimatedTiles","../src/animated-tiles.js"),this.load.setBaseURL("./assets/"),this.load.tilemapTiledJSON("map","sma-loris.json"),this.load.image("ground_tiles","ground_tiles.png"),this.load.image("beach_sand_woa3","beach_sand_woa3.png"),this.load.image("pixel","pixel.png"),this.load.image("bar","bar.png"),this.lastPress=!1,this.load.spritesheet("loris","loris-sprite.png",{frameWidth:45,frameHeight:45}),this.load.spritesheet("wolf","betterwolfsprite.png",{frameWidth:70,frameHeight:70}),console.log("preload finished")};var p=0;s.create=function(){var e;this.sys.install("AnimatedTiles"),r=this.make.tilemap({key:"map"}),console.log(r),i=r.addTilesetImage("avalon-ground","ground_tiles"),o=r.addTilesetImage("av-waves-3","beach_sand_woa3"),console.log("go fetch Avalon Ground tiles"),console.log(i),r.createDynamicLayer("Base",i,0,0),r.createDynamicLayer("waves",o,0,0),console.log("Charmed"),this.sys.animatedTiles.init(r),this.Finder=window.EasyStar.js(),this.health_bottom=this.add.image(50,40,"pixel").setScrollFactor(0),this.health_bottom.scaleX=-260,this.health_bottom.scaleY=20,this.health_top=this.add.image(50,40,"pixel").setScrollFactor(0),console.log("health image"),console.log(this.health_top),this.health_top.scaleX=-260,this.health_top.scaleY=20,console.log("Health bar:"),lebar=this.add.image(180,30,"bar").setScrollFactor(0),lebar.scaleX=3,lebar.scaleY=2,console.log(this.health_top),this.health_top.setTint(16711680),this.cameras.main.setSize(800,800),console.log("Main Camera"),console.log(this.cameras.main),leftKey=m.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.J),rightKey=m.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.L),downKey=m.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.K),upKey=m.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.I),angleKey=m.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.A),healthKey=m.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.H),player=this.physics.add.sprite(300,150,"loris"),this.cameras.main.startFollow(player),console.log("Player object:"),console.log(player),Loris=new class{constructor(e){this.starting_health=100,this.cooldown=2e3,this.health=this.starting_health,this.x=0,this.y=0}setPosition(e,t){this.x=e,this.y=t}injure(e){updateHUD(-1*e),this.health-=e}updateHUD(e){}},this.DM=new class{constructor(e,t,a,s){for(this.name=e,this.num_mobs=t,this.spawn_period=a,this.creation_time=!1,this.mob_box=[],this.sprite_lever=s;this.mob_box.length<t;)this.spawn_mob("wolf",10)}tick(e,t){for(var a in this.mob_box.length<this.num_mobs&&this.mob_roll(e),this.mob_box)this.mob_box[a].tick()}mob_roll(e,t){roll=Math.random(e),mob_prob=t/this.spawn_period*6e4,roll<=mob_prob&&this.spawn_mob("wolf",10)}spawn_mob(e,t){let s=this.get_spawn_coord(),r=this.sprite_lever.sprite(s.x,s.y,e),o=new a(r,e,t);this.mob_box.push(o)}get_spawn_coord(){let e=[{x:200,y:299},{x:100,y:199},{x:140,y:399}];return e[Math.floor(Math.random()*e.length)]}}("wolf",3,7,this.physics.add),player.setBounce(.2),console.log("Game Object:"),console.log(m),player.setCollideWorldBounds(!0),player.body.setGravityY(0),(e=this.anims).create({key:"wolf-walk-left",frames:e.generateFrameNumbers("wolf",{start:14,end:18}),frameRate:10,repeat:-1}),e.create({key:"wolf-walk-right",frames:e.generateFrameNumbers("wolf",{start:1,end:5}),frameRate:10,repeat:-1}),e.create({key:"wolf-walk-down",frames:e.generateFrameNumbers("wolf",{start:6,end:9}),frameRate:10,repeat:-1}),e.create({key:"wolf-walk-up",frames:e.generateFrameNumbers("wolf",{start:19,end:22}),frameRate:10,repeat:-1}),function(e){e.create({key:"player-left",frames:e.generateFrameNumbers("loris",{start:3,end:5}),frameRate:5,repeat:-1}),e.create({key:"player-right",frames:e.generateFrameNumbers("loris",{start:6,end:8}),frameRate:5,repeat:-1}),e.create({key:"player-up",frames:e.generateFrameNumbers("loris",{start:9,end:11}),frameRate:5,repeat:-1}),e.create({key:"player-down",frames:e.generateFrameNumbers("loris",{start:0,end:2}),frameRate:5,repeat:-1}),e.create({key:"player-down-stop",frames:[{key:"loris",frame:0}],frameRate:20}),e.create({key:"player-up-stop",frames:[{key:"loris",frame:9}],frameRate:20}),e.create({key:"player-left-stop",frames:[{key:"loris",frame:3}],frameRate:20}),e.create({key:"player-right-stop",frames:[{key:"loris",frame:6}],frameRate:20})}(this.anims),l=5e3},s.update=function(e,t){Loris.health<=0&&h&&(p=2e3,h=!1,console.log("ded")),p>0&&(p-=t,this.cameras.main.shake(500));angleKey.isDown&&player.setAngularVelocity(400),function(e,t,a,s,r){x=0,y=0,e.isDown?(x-=r,this.player.anims.play("player-left",!0),this.lastPress="left"):t.isDown?(x+=r,this.player.anims.play("player-right",!0),this.lastPress="right"):a.isDown?(y-=r,this.player.anims.play("player-up",!0),this.lastPress="up"):s.isDown?(y+=r,player.anims.play("player-down",!0),this.lastPress="down"):(this.lastPress?animation="player-"+this.lastPress+"-stop":animation="player-up-stop",player.anims.play(animation,!0));!function(e,t,a){e.setVelocityX(t),e.setVelocityY(a)}(player,x,y)}(leftKey,rightKey,upKey,downKey,60),this.DM.tick(),(l-=t)<0&&!n&&(console.log(this.sys),this.sys.animatedTiles.updateAnimatedTiles(),n=!0)};var d={type:Phaser.AUTO,width:800,height:800,physics:{default:"arcade",arcade:{gravity:{y:0},debug:!1}},scene:s},m=new Phaser.Game(d)}]);